---
import Base from "../layouts/Base.astro";
import Post from "../components/Post.astro"; 
const posts = await Astro.glob("./date/**/*.{md,mdx}");
let today = new Date().toLocaleDateString("en-us", {
  month: "short",
  day: "2-digit",
});

const todaysDate = posts.filter(
  (post) =>
    new Date(post.frontmatter.date).toLocaleDateString("en-us", {
      month: "short",
      day: "2-digit",
    }) === today
);
const endpoint = todaysDate.map(post => post.url); 
const forwardURL = `${Astro.url.pathname.replace(/\/$/, '')}${endpoint}`;
---

<Base>
  {
    todaysDate.map((post) => (
      <Post title={post.frontmatter.title} date={post.frontmatter.date}>
        <section set:html={post.compiledContent()} />
      </Post>
    ))
  }
</Base>

<script define:vars={{forwardURL}}>
  // window.location.replace(`${forwardURL}`);
</script>